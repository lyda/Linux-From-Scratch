<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  <!ENTITY % patches-entities SYSTEM "../../patches.ent">
  %general-entities;
  %patches-entities;
]>

<sect1 id="ch-temp-system-bash" role="wrap">
  <?dbhtml filename="bash.html"?>

  <title>Bash-&bash-version;</title>

  <indexterm zone="ch-temp-system-bash">
    <primary sortas="a-Bash">Bash</primary>
    <secondary>temporary system</secondary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../../final-system/common/bash.xml"
    xpointer="xpointer(id('package-bash')/para[1])"/>

    <segmentedlist>
      <segtitle>&buildtime;</segtitle>
      <segtitle>&diskspace;</segtitle>

      <seglistitem>
        <seg>Not checked yet</seg>
        <seg>Not checked yet</seg>
      </seglistitem>
    </segmentedlist>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../../final-system/common/bash.xml"
    xpointer="xpointer(id('package-bash')/segmentedlist[2])"/>

  </sect2>

  <sect2 role="installation">
    <title>Installation of Bash</title>

    <para>Fix a minor issue during the build when cross-compling:</para>

<screen><userinput>cp -p Makefile.in Makefile.in.orig
sed "s@size \$(Program)@${LFS_TARGET}-&amp;@g"  Makefile.in.orig > Makefile.in</userinput></screen>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../../final-system/common/bash.xml"
    xpointer="xpointer(id('install-bash')/para[2])"/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../../final-system/common/bash.xml"
    xpointer="xpointer(id('install-bash')/screen[2])"/>

    <para>Prepare Bash for compilation:</para>

<screen><userinput>./configure --prefix=/tools --with-curses \
   --without-bash-malloc --host=${LFS_TARGET}</userinput></screen>

    <variablelist>
      <title>The meaning of the configure option:</title>

      <varlistentry>
        <term><parameter>--without-bash-malloc</parameter></term>
        <listitem>
          <para>This options turns off the use of Bash's memory allocation
          (malloc) function which is known to cause segmentation faults.
          By turning this option off, Bash will use the malloc functions
          from Glibc which are more stable.</para>
        </listitem>
      </varlistentry>

    </variablelist>

    <para>Compile the package:</para>

<screen><userinput>make LDFLAGS="-s"</userinput></screen>

    <para>Install the package:</para>

<screen><userinput>make install</userinput></screen>

    <para>Make a link for the programs that use <command>sh</command> for
    a shell:</para>

<screen><userinput>ln -s bash /tools/bin/sh</userinput></screen>

    <para/>

  </sect2>

  <sect2 role="content">
    <title/>

    <para>Details on this package are located in <xref
    linkend="contents-bash" role="."/></para>

  </sect2>

</sect1>
